<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LRU Cache Visualizer</title>
    <style>
        :root {
            --bg-color: #1e1e2e;
            --card-bg: #313244;
            --primary: #89b4fa;
            --success: #a6e3a1;
            --danger: #f38ba8;
            --text: #cdd6f4;
            --subtext: #a6adc8;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
        }

        h1 { margin-bottom: 10px; color: var(--primary); }
        p { color: var(--subtext); margin-bottom: 30px; }

        .controls {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        input {
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #45475a;
            background: #181825;
            color: white;
            width: 80px;
            outline: none;
        }

        button {
            padding: 10px 20px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
        }

        .btn-put { background-color: var(--success); color: #1e1e2e; }
        .btn-put:hover { opacity: 0.9; transform: translateY(-2px); }

        .btn-get { background-color: var(--primary); color: #1e1e2e; }
        .btn-get:hover { opacity: 0.9; transform: translateY(-2px); }

        .btn-reset { background-color: var(--danger); color: #1e1e2e; }

        .cache-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-bottom: 20px;
        }

        .boundary {
            font-weight: bold;
            color: var(--danger);
            padding: 10px 15px;
            border: 2px dashed var(--danger);
            border-radius: 8px;
            white-space: nowrap;
        }

        .cache-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 0 20px;
            min-height: 120px;
            flex-wrap: wrap;
        }

        .node {
            background: linear-gradient(145deg, #313244, #3b3d52);
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 15px;
            min-width: 80px;
            text-align: center;
            animation: popIn 0.3s ease-out;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            position: relative;
        }

        .key-label { font-size: 0.8em; color: var(--subtext); display: block; }
        .val-label { font-size: 1.2em; font-weight: bold; color: white; display: block; }

        .arrow { font-size: 24px; color: var(--subtext); }

        .log-container {
            width: 100%;
            max-width: 600px;
            background: #11111b;
            border-radius: 8px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border: 1px solid #45475a;
        }

        .log-entry { margin: 5px 0; border-bottom: 1px solid #313244; padding-bottom: 2px; }
        .log-success { color: var(--success); }
        .log-error { color: var(--danger); }
        .log-info { color: var(--primary); }

        @keyframes popIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body>

    

    <h1>LRU Cache Visualizer</h1>
    <p>Capacity: 3</p>

    <div class="controls">
        <div>
            <input type="number" id="keyInput" placeholder="Key">
            <input type="number" id="valInput" placeholder="Value">
            <button class="btn-put" onclick="handlePut()">Put</button>
        </div>
        <div>
            <input type="number" id="getKeyInput" placeholder="Key">
            <button class="btn-get" onclick="handleGet()">Get</button>
        </div>
        <button class="btn-reset" onclick="resetCache()">Reset</button>
    </div>

    <div class="cache-wrapper">
        <div class="boundary">HEAD (MRU)</div>
        <div id="visualizer" class="cache-container"></div>
        <div class="boundary">TAIL (LRU)</div>
    </div>

    <div class="log-container" id="logs"></div>

    <script>
        class Node {
            constructor(key, value) {
                this.key = key;
                this.value = value;
                this.prev = null;
                this.next = null;
            }
        }

        class LRUCache {
            constructor(capacity) {
                this.capacity = capacity;
                this.size = 0;
                this.map = new Map();
                this.head = new Node(0, 0);
                this.tail = new Node(0, 0);
                this.head.next = this.tail;
                this.tail.prev = this.head;
            }

            addNode(node) {
                node.prev = this.head;
                node.next = this.head.next;
                this.head.next.prev = node;
                this.head.next = node;
            }

            removeNode(node) {
                let prev = node.prev;
                let next = node.next;
                prev.next = next;
                next.prev = prev;
            }

            moveToHead(node) {
                this.removeNode(node);
                this.addNode(node);
            }

            popTail() {
                let res = this.tail.prev;
                this.removeNode(res);
                return res;
            }

            get(key) {
                if (!this.map.has(key)) return -1;
                let node = this.map.get(key);
                this.moveToHead(node);
                return node.value;
            }

            put(key, value) {
                if (this.map.has(key)) {
                    let node = this.map.get(key);
                    node.value = value;
                    this.moveToHead(node);
                    return "Updated";
                } else {
                    let newNode = new Node(key, value);
                    this.map.set(key, newNode);
                    this.addNode(newNode);
                    this.size++;

                    if (this.size > this.capacity) {
                        let tail = this.popTail();
                        this.map.delete(tail.key);
                        this.size--;
                        return "Evicted";
                    }
                    return "Inserted";
                }
            }

            getAsArray() {
                let result = [];
                let curr = this.head.next;
                while (curr !== this.tail) {
                    result.push(curr);
                    curr = curr.next;
                }
                return result;
            }
        }

        let cache = new LRUCache(3);

        function log(message, type = 'log-info') {
            const logContainer = document.getElementById('logs');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `> ${message}`;
            logContainer.prepend(entry);
        }

        function render() {
            const container = document.getElementById('visualizer');
            container.innerHTML = '';
            
            const nodes = cache.getAsArray();

            if (nodes.length === 0) {
                container.innerHTML = '<span style="color:gray">Cache is Empty</span>';
                return;
            }

            nodes.forEach((node, index) => {
                const div = document.createElement('div');
                div.className = 'node';
                div.innerHTML = `
                    <span class="key-label">Key: ${node.key}</span>
                    <span class="val-label">${node.value}</span>
                `;
                
                container.appendChild(div);
                if (index < nodes.length - 1) {
                    const arrow = document.createElement('div');
                    arrow.className = 'arrow';
                    arrow.innerHTML = '&harr;';
                    container.appendChild(arrow);
                }
            });
        }

        function handlePut() {
            const key = parseInt(document.getElementById('keyInput').value);
            const val = parseInt(document.getElementById('valInput').value);

            if (isNaN(key) || isNaN(val)) {
                log("Invalid Input", "log-error");
                return;
            }

            const result = cache.put(key, val);
            
            if (result === "Updated") {
                log(`Updated Key ${key} -> Value ${val}`, "log-info");
            } else if (result === "Evicted") {
                log(`Inserted Key ${key} (LRU Evicted)`, "log-success");
            } else {
                log(`Inserted Key ${key}, Value ${val}`, "log-success");
            }
            render();
        }

        function handleGet() {
            const key = parseInt(document.getElementById('getKeyInput').value);
            if (isNaN(key)) return;

            const val = cache.get(key);
            if (val === -1) {
                log(`Key ${key} not found`, "log-error");
            } else {
                log(`Accessed Key ${key} (Value: ${val})`, "log-success");
            }
            render();
        }

        function resetCache() {
            cache = new LRUCache(3);
            log("Cache cleared", "log-info");
            render();
        }

        render();
        log("Ready. Capacity: 3");

    </script>
</body>
</html>
